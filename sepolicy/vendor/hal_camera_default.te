hal_client_domain(hal_camera_default, hal_cameraHIDL)

allow hal_camera_default mnt_vendor_file:dir w_dir_perms;
allow hal_camera_default mnt_vendor_file:file create_file_perms;

allow hal_camera_default oem_file:dir w_dir_perms;
allow hal_camera_default oem_file:file create_file_perms;

allow hal_camera_default vendor_persist_file:dir w_dir_perms;
allow hal_camera_default vendor_persist_file:file create_file_perms;

allow hal_camera_default input_device:dir { read open search };
allow hal_camera_default input_device:chr_file { ioctl read open };

allow hal_camera_default vl53l1_device:chr_file rw_file_perms;

allow hal_camera_default aac_drc_prop:file { getattr map open };
allow hal_camera_default ab_update_gki_prop:file { getattr map open };
allow hal_camera_default adbd_config_prop:file { getattr map open };
allow hal_camera_default apexd_config_prop:file { getattr map open };
allow hal_camera_default apk_verity_prop:file { getattr map open };
allow hal_camera_default audio_config_prop:file { getattr map open };
allow hal_camera_default bluetooth_a2dp_offload_prop:file { getattr map open };
allow hal_camera_default bluetooth_audio_hal_prop:file { getattr map open };
allow hal_camera_default bootanim_config_prop:file { getattr map open };
allow hal_camera_default bootanim_system_prop:file { getattr map open };
allow hal_camera_default boot_status_prop:file { getattr map open };
allow hal_camera_default boottime_public_prop:file { getattr map open };
allow hal_camera_default build_bootimage_prop:file { getattr map open };
allow hal_camera_default camera2_extensions_prop:file { getattr map open };
allow hal_camera_default camera_config_prop:file { getattr map open };
allow hal_camera_default camerax_extensions_prop:file { getattr map open };
allow hal_camera_default cgroup:file getattr;
allow hal_camera_default codec2_config_prop:file { getattr map open };
allow hal_camera_default cpu_variant_prop:file { getattr map open };
allow hal_camera_default device_config_runtime_native_prop:file { getattr map open };
allow hal_camera_default device_logging_prop:file { getattr map open };
allow hal_camera_default drm_service_config_prop:file { getattr map open };
allow hal_camera_default dumpstate_options_prop:file { getattr map open };
allow hal_camera_default exported_bluetooth_prop:file { getattr open };
allow hal_camera_default exported_bluetooth_prop:file map;
allow hal_camera_default exported_overlay_prop:file { getattr map open };
allow hal_camera_default framework_watchdog_config_prop:file { getattr map };
allow hal_camera_default framework_watchdog_config_prop:file open;
allow hal_camera_default graphics_config_prop:file { getattr map open };
allow hal_camera_default hdmi_config_prop:file { getattr map open };
allow hal_camera_default incremental_prop:file { getattr map open };
allow hal_camera_default lmkd_config_prop:file { getattr map open };
allow hal_camera_default lmkd_prop:file { getattr map open };
allow hal_camera_default logpersistd_logging_prop:file { getattr map open };
allow hal_camera_default lowpan_prop:file { getattr map open };
allow hal_camera_default media_config_prop:file { getattr map open };
allow hal_camera_default media_variant_prop:file { getattr map open };
allow hal_camera_default nnapi_ext_deny_product_prop:file { getattr map open };
allow hal_camera_default persist_vendor_debug_wifi_prop:file { getattr map open };
allow hal_camera_default powerctl_prop:file { getattr map open };
allow hal_camera_default power_debug_prop:file { getattr map open };
allow hal_camera_default proc_meminfo:file r_file_perms;
allow hal_camera_default qemu_hw_prop:file { getattr map open };
allow hal_camera_default qemu_sf_lcd_density_prop:file { getattr map open };
allow hal_camera_default radio_control_prop:file { getattr map open };
allow hal_camera_default rebootescrow_hal_prop:file { getattr map };
allow hal_camera_default rebootescrow_hal_prop:file open;
allow hal_camera_default recovery_config_prop:file { getattr map open };
allow hal_camera_default retaildemo_prop:file getattr;
allow hal_camera_default serialno_prop:file { getattr map open };
allow hal_camera_default storage_config_prop:file { getattr map open };
allow hal_camera_default surfaceflinger_color_prop:file { getattr map open };
allow hal_camera_default surfaceflinger_display_prop:file { getattr map open };
allow hal_camera_default suspend_prop:file { getattr map open };
allow hal_camera_default system_boot_reason_prop:file { getattr map };
allow hal_camera_default system_boot_reason_prop:file open;
allow hal_camera_default telephony_config_prop:file { getattr map open };
allow hal_camera_default test_harness_prop:file { getattr map };
allow hal_camera_default test_harness_prop:file open;
allow hal_camera_default theme_prop:file { getattr map };
allow hal_camera_default theme_prop:file open;
allow hal_camera_default usb_config_prop:file { getattr map };
allow hal_camera_default usb_config_prop:file open;
allow hal_camera_default usb_control_prop:file { getattr map };
allow hal_camera_default usb_control_prop:file open;
allow hal_camera_default userspace_reboot_config_prop:file { getattr map };
allow hal_camera_default userspace_reboot_config_prop:file open;
allow hal_camera_default userspace_reboot_exported_prop:file { getattr map };
allow hal_camera_default userspace_reboot_exported_prop:file open;
allow hal_camera_default vehicle_hal_prop:file { getattr map open };
allow hal_camera_default vendor_alarm_boot_prop:file { getattr open };
allow hal_camera_default vendor_alarm_boot_prop:file map;
allow hal_camera_default vendor_audio_prop:file { getattr map open };
allow hal_camera_default vendor_bluetooth_prop:file { getattr map };
allow hal_camera_default vendor_bluetooth_prop:file open;
allow hal_camera_default vendor_boot_mode_prop:file { getattr map };
allow hal_camera_default vendor_boot_mode_prop:file open;
allow hal_camera_default vendor_bservice_prop:file { getattr map open };
allow hal_camera_default vendor_cap_configstore_dbg_prop:file { getattr map open };
allow hal_camera_default vendor_cgroup_follow_prop:file { getattr map };
allow hal_camera_default vendor_cgroup_follow_prop:file open;
allow hal_camera_default vendor_cnd_prop:file { getattr map open };
allow hal_camera_default vendor_cnd_vendor_prop:file { getattr map };
allow hal_camera_default vendor_cnd_vendor_prop:file open;
allow hal_camera_default vendor_console_log_level_prop:file { getattr map };
allow hal_camera_default vendor_console_log_level_prop:file open;
allow hal_camera_default vendor_core_ctl_prop:file { getattr open };
allow hal_camera_default vendor_crash_cnt_prop:file open;
allow hal_camera_default vendor_ctl_netmgrd_prop:file open;
allow hal_camera_default vendor_ctl_rild_prop:file map;
allow hal_camera_default vendor_ctl_vendor_imsrcsservice_prop:file open;
allow hal_camera_default vendor_ctl_vendor_mmid_prop:file open;
allow hal_camera_default vendor_ctl_vendor_wigigsvc_prop:file open;
allow hal_camera_default vendor_dataadpl_prop:file open;
allow hal_camera_default vendor_data_ko_prop:file open;
allow hal_camera_default vendor_dataqdp_prop:file open;
allow hal_camera_default vendor_dataqti_prop:file open;
allow hal_camera_default vendor_data_shsusr_prop:file open;
allow hal_camera_default vendor_dbg_brkpoint_prop:file open;
allow hal_camera_default vendor_dcvs_prop:file open;
allow hal_camera_default vendor_disable_spu_prop:file { map open };
allow hal_camera_default vendor_display_prop:file open;
allow hal_camera_default vendor_face3d_producer_prop:file { getattr map open };
allow hal_camera_default vendor_fda_prop:file { getattr map open };
allow hal_camera_default vendor_gpu_prop:file { getattr map open };
allow hal_camera_default vendor_hvdcp_opti_prop:file { getattr map open };
allow hal_camera_default vendor_ims_prop:file { getattr map open };
allow hal_camera_default vendor_iop_prop:file { getattr map open };
allow hal_camera_default vendor_ipacm-diag_prop:file { getattr map open };
allow hal_camera_default vendor_ipacm_prop:file { getattr map open };
allow hal_camera_default vendor_mdm_helper_prop:file { getattr map open };
allow hal_camera_default vendor_mm_parser_prop:file { getattr map open };
allow hal_camera_default vendor_modem_diag_prop:file { getattr open };
allow hal_camera_default vendor_mpctl_prop:file open;
allow hal_camera_default vendor_mwqem_prop:file getattr;
allow hal_camera_default vendor_mwqem_prop:file open;
allow hal_camera_default vendor_nfc_nq_prop:file open;
allow hal_camera_default vendor_pasr_prop:file open;
allow hal_camera_default vendor_pd_locater_dbg_prop:file open;
allow hal_camera_default vendor_per_mgr_state_prop:file open;
allow hal_camera_default vendor_persist_rcs_prop:file getattr;
allow hal_camera_default vendor_persist_rcs_prop:file { map open };
allow hal_camera_default vendor_persist_tcm_prop:file open;
allow hal_camera_default vendor_qcc_prop:file { getattr open };
allow hal_camera_default vendor_qcc_prop:file map;
allow hal_camera_default vendor_qdcmss_prop:file getattr;
allow hal_camera_default vendor_qdcmss_prop:file open;
allow hal_camera_default vendor_qspm_prop:file open;
allow hal_camera_default vendor_qteeconnector_opti_prop:file open;
allow hal_camera_default vendor_qvrd_persist_prop:file open;
allow hal_camera_default vendor_qvrd_prop:file open;
allow hal_camera_default vendor_qvr_persist_prop:file { getattr map };
allow hal_camera_default vendor_qvr_persist_prop:file open;
allow hal_camera_default vendor_qvr_prop:file { getattr map };
allow hal_camera_default vendor_qvr_prop:file open;
allow hal_camera_default vendor_radio_prop:file getattr;
allow hal_camera_default vendor_radio_prop:file open;
allow hal_camera_default vendor_ramdump_prop:file open;
allow hal_camera_default vendor_reschedule_service_prop:file open;
allow hal_camera_default vendor_sensors_dbg_prop:file open;
allow hal_camera_default vendor_sensors_prop:file open;
allow hal_camera_default vendor_slm_prop:file open;
allow hal_camera_default vendor_soc_model_prop:file { getattr open };
allow hal_camera_default vendor_spcomlib_prop:file open;
allow hal_camera_default vendor_ssr_prop:file open;
allow hal_camera_default vendor_sxr_prop:file open;
allow hal_camera_default vendor_sysfs_video_call_on:file rw_file_perms;
allow hal_camera_default vendor_sys_video_prop:file getattr;
allow hal_camera_default vendor_tee_listener_prop:file open;
allow hal_camera_default vendor_time_service_prop:file open;
allow hal_camera_default vendor_usb_prop:file open;
allow hal_camera_default vendor_video_prop:file open;
allow hal_camera_default vendor_wfd_vendor_debug_prop:file open;
allow hal_camera_default vendor_wifi_prop:file open;
allow hal_camera_default vendor_wigig_prop:file open;
allow hal_camera_default vendor_wlc_prop:file open;
allow hal_camera_default vendor_xlat_prop:file open;
allow hal_camera_default virtual_ab_prop:file open;
allow hal_camera_default vold_config_prop:file open;
allow hal_camera_default vold_post_fs_data_prop:file open;
allow hal_camera_default vts_status_prop:file open;
allow hal_camera_default wifi_hal_prop:file open;
allow hal_camera_default zram_config_prop:file open;
allow hal_camera_default zram_control_prop:file open;
allow hal_camera_default zygote_config_prop:file open;

# Allow camera to read over /dev/adsprpc-smd-secure 
allow hal_camera_default vendor_xdsp_device:chr_file { ioctl read write open };

allow hal_camera_default cgroup:file getattr;
allow hal_camera_default hal_cameraHIDL_hwservice:hwservice_manager find;
allow hal_camera_default public_adsprpcd_file:file { read open getattr };

get_prop(hal_camera_default, ctl_default_prop)
get_prop(hal_camera_default, vendor_mmi_prop)
